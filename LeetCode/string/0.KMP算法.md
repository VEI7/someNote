# KMPç®—æ³•

### æ¨¡å¼åŒ¹é…(Pattern Matching)

- ä¸€ä¸ªç›®æ ‡å¯¹è±¡Tï¼ˆå­—ç¬¦ä¸²ï¼‰

- ä¸€ä¸ªæ¨¡æ¿ï¼ˆpatternï¼‰Pï¼ˆå­—ç¬¦ä¸²ï¼‰

ä»»åŠ¡ï¼šç”¨ç»™å®šçš„æ¨¡æ¿Pï¼Œåœ¨ç›®æ ‡å­—ç¬¦ä¸²Tä¸­æœç´¢ä¸æ¨¡æ¿På…¨ç›¸åŒçš„ä¸€ä¸ªå­ä¸²ï¼Œå¹¶è¿”å›P å’ŒTåŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ä¸²çš„é¦–å­—ç¬¦ä½ç½®

ä¸ºä½¿æ—¶é—´å¤æ‚åº¦å¯ä»¥è¾¾åˆ°**O(m+n)**, éœ€è¦å¯»æ‰¾ä¸€ä¸ªæ— å›æº¯(Tçš„æ¸¸æ ‡ä¸åé€€)çš„åŒ¹é…ç®—æ³•ï¼Œå…³é”®åœ¨äºåŒ¹é…è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦Pi å’ŒTjæ¯”è¾ƒä¸ç­‰æ—¶ï¼Œèƒ½ç«‹å³ç¡®å®šPå³ç§»çš„ä½æ•°ï¼Œå³è¯¥ç”¨Pä¸­çš„å“ªä¸ªå­—ç¬¦å’ŒTjè¿›è¡Œæ¯”è¾ƒã€‚

**KMPç®—æ³•**ï¼šPä¸­æ¯ä¸ªå­—ç¬¦å¯¹åº”ä¸€ä¸ªç§»ä½å€¼$n_i$ï¼Œè¯¥å€¼ä»…ä¾èµ–äºæ¨¡å¼Pæœ¬èº«ï¼Œä¸ç›®æ ‡Tæ— å…³

**è®¡ç®—ç‰¹å¾æ•°$n_i$**

![image-20191030163122335](/var/folders/dp/_cdw_jwj6xd7qlybydtwn6k80000gn/T/abnerworks.Typora/image-20191030163122335.png)

è®¾æ³•æ±‚å‡ºæœ€é•¿çš„ï¼ˆkæœ€å¤§çš„ï¼‰èƒ½å¤Ÿä¸å‰ç¼€å­ä¸²åŒ¹é…çš„å·¦å­ä¸²ï¼ˆç®€ç§°ç¬¬iä½çš„æœ€é•¿å‰ç¼€ä¸²ï¼‰ï¼Œkå°±æ˜¯è¦æ±‚çš„ç‰¹å¾æ•°$n_i$.

![image-20191030163244856](/var/folders/dp/_cdw_jwj6xd7qlybydtwn6k80000gn/T/abnerworks.Typora/image-20191030163244856.png)



#### findnextéä¼˜åŒ–ç®—æ³•

```c++
int findNext(string P) {
    int i, k;
    int m = P.length( );      //mä¸ºæ¨¡æ¿Pçš„é•¿åº¦
    int *next = new  int[m]; //åŠ¨æ€å­˜å‚¨åŒºå¼€è¾Ÿæ•´æ•°æ•°ç»„
    next[0] = -1;   
    i = 0;  k = -1;
    while (i < m-1) {        // è‹¥å†™æˆ i < m ä¼šè¶Šç•Œ
        //å¦‚æœä¸ç­‰ï¼Œé‡‡ç”¨ KMP æ–¹æ³•è‡ªæ‰¾é¦–å°¾å­ä¸²
        while (k >= 0 && P[k] != P[i])
            k = next[k];          // k é€’å½’åœ°å‘å‰æ‰¾
        i++;   k++;       
        next[i] = k;   
    }
    return next;
}
```

####

####findnextä¼˜åŒ–ç®—æ³•

$$
next[i]=
\begin{cases}
maxâ¡\{ğ‘˜:0<ğ‘˜<ğ‘– \&\& P(0...k-1)=P(i-k...i-1)\&\&P(k)!=p(i)\}& \text{å¦‚æœkå­˜åœ¨}\\
-1   \ \ \ \ \ \ \text{i=0 æˆ–è€… ä¸Šè¿°kä¸å­˜åœ¨ä¸”P(k)==P(0)}\\
0  \ \ \ \ \ \ \ \ \ \text{å¦åˆ™}
\end{cases}
$$

```c++
int findNext*(string P) {
    int i, k;
    int m = P.length( );          //mä¸ºæ¨¡æ¿Pçš„é•¿åº¦
    int *next = new  int[m];      //åŠ¨æ€å­˜å‚¨åŒºå¼€è¾Ÿæ•´æ•°æ•°ç»„
    next[0] = -1;   
    i = 0;  k = -1;
    while (i < m-1) {             //è‹¥å†™æˆi < m ä¼šè¶Šç•Œ
        while (k >= 0 && P[k] != P[i]) //æ‰¾é¦–å°¾å­ä¸²
              k = next[k];        //ké€’å½’åœ°å‘å‰æ‰¾
        i++;   k++; 
        if (P[k] == P[i])   
              next[i] = next[k];  //next[i]è¡¨ç¤ºP[i]å¤±é…çš„æ—¶å€™ï¼Œéœ€è¦ç”¨P[next[i]]å»è¯•å›¾åŒ¹é…ã€‚ä½†æ˜¯å¦‚æœP[i]==P[k]ï¼Œæ„å‘³ç€å¦‚æœP[i]å¤±é…ï¼Œåˆ™P[k]ä¹Ÿä¸€å®šä¼šå¤±é…ï¼›å› æ­¤æˆ‘ä»¬å¯ä»¥è¿­ä»£å†å»qæ±‚next[i]=next[k].

        else next[i] = k;        
    }
    return next;
}
```



#### KMPç®—æ³•

```c++
int KMPStrMatching(string T, string P,  int *N, int start) {
   int i= 0;                           // æ¨¡å¼çš„ä¸‹æ ‡å˜é‡
   int j = start;                      // ç›®æ ‡çš„ä¸‹æ ‡å˜é‡
   int pLen = P.length( );             // æ¨¡å¼çš„é•¿åº¦
   int tLen = T.length( );             // ç›®æ ‡çš„é•¿åº¦
   if (tLen - start < pLen)            // è‹¥ç›®æ ‡æ¯”æ¨¡å¼çŸ­ï¼ŒåŒ¹é…æ— æ³•æˆåŠŸ
       return (-1);          
   while ( i < pLen  &&  j < tLen)  {  // åå¤æ¯”è¾ƒå¯¹åº”å­—ç¬¦æ¥å¼€å§‹åŒ¹é…
       if ( i == -1  ||  T[j] == P[i]) 
           i++,  j++;
       else i = Next[i];
   }
   if (i >= pLen)
       return (j-pLen+1);                    
   else return (-1);
}

```





